<p-card class="mt-4 p-4">
  <h2>Articles</h2>

  <form [formGroup]="form" (ngSubmit)="submit()" class="flex flex-column gap-4 mt-3">

    <div class="flex flex-column w-full">
      <p-floatlabel variant="on">
        <input
          pInputText
          id="name"
          formControlName="name"
          class="w-full"
          autocomplete="off"
        />
        <label for="name">Name</label>
      </p-floatlabel>

      <small class="p-error" *ngIf="f['name'].touched && f['name'].invalid">
        Name is required (3–10 characters)
      </small>
    </div>

    <div class="flex flex-column w-full">
      <p-floatlabel variant="on">
        <input
          pInputText
          id="description"
          formControlName="description"
          class="w-full"
          autocomplete="off"
        />
        <label for="description">Description</label>
      </p-floatlabel>

      <small class="p-error" *ngIf="f['description'].touched && f['description'].invalid">
        Description is limited to 20 characters maximum
      </small>
    </div>

    <div class="flex flex-column w-full">
      <p-floatlabel variant="on">
        <input
          pInputText
          id="ean"
          formControlName="ean"
          class="w-full"
          autocomplete="off"
        />
        <label for="ean">EAN</label>
      </p-floatlabel>

      <small class="p-error" *ngIf="f['ean'].touched && f['ean'].invalid">
        EAN must be 8–13 digits
      </small>
    </div>

    <div class="flex flex-column w-full">
      <p-floatlabel variant="on">
        <input
          pInputText
          id="unit"
          formControlName="unit"
          class="w-full"
          autocomplete="off"
        />
        <label for="unit">Unit</label>
      </p-floatlabel>

      <small class="p-error" *ngIf="f['unit'].touched && f['unit'].invalid">
        Unit is required
      </small>
    </div>

    <p-button
      label="{{ form.value.id ? 'Update' : 'Create' }}"
      type="submit"
      [disabled]="form.invalid || !form.dirty"
      class="mt-2 w-full">
    </p-button>

  </form>
</p-card>

<p-card class="mt-4 p-4">
  <p-table [value]="articles">
    <ng-template pTemplate="header">
      <tr>
        <th>Name</th>
        <th>EAN</th>
        <th>Unit</th>
        <th>Actions</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-article>
      <tr>
        <td>{{ article.name }}</td>
        <td>{{ article.ean }}</td>
        <td>{{ article.unit }}</td>
        <td class="flex gap-2">
          <p-button 
            label="Edit" 
            icon="pi pi-pencil" 
            class="p-button-sm p-button-warning" 
            (onClick)="edit(article)">
          </p-button>
          <p-button
            label="Delete"
            icon="pi pi-trash"
            iconPos="left"
            severity="danger"
            class="p-button-sm"
            (onClick)="delete(article.id)">
          </p-button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</p-card>