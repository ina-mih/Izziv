<p-card class="mt-4 p-4">
  <h2>Locations</h2>

  <form [formGroup]="form" (ngSubmit)="submit()" class="flex flex-column gap-3 mt-3">

    <div class="flex flex-column w-full">
      <p-floatlabel variant="on">
        <input
          pInputText
          id="code"
          formControlName="code"
          class="w-full"
          autocomplete="off" />
        <label for="code">Location Code</label>
      </p-floatlabel>

      <small class="p-error" *ngIf="f['code'].touched && f['code'].invalid">
        Code is required (3–7 characters)
      </small>
    </div>

    <div class="flex flex-column w-full">
      <p-floatlabel variant="on">
        <input
          pInputText
          id="name"
          formControlName="name"
          class="w-full"
          autocomplete="off" />
        <label for="name">Location Name</label>
      </p-floatlabel>

      <small class="p-error" *ngIf="f['name'].touched && f['name'].invalid">
        Name is required (3–20 characters)
      </small>
    </div>

    <p-button
      label="{{ form.value.id ? 'Update' : 'Create' }}"
      type="submit"
      [disabled]="form.invalid || !form.dirty"
      class="mt-2 w-full">
    </p-button>

  </form>
</p-card>

<p-card class="mt-4 p-4">
  <p-table [value]="locations">
    <ng-template pTemplate="header">
      <tr>
        <th>Code</th>
        <th>Name</th>
        <th>Actions</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-location>
      <tr>
        <td>{{ location.code }}</td>
        <td>{{ location.name }}</td>
        <td class="flex gap-2">
          <p-button
            label="Edit"
            icon="pi pi-pencil"
            class="p-button-sm p-button-warning"
            (onClick)="edit(location)">
          </p-button>
          <p-button
            label="Delete"
            icon="pi pi-trash"
            iconPos="left"
            severity="danger"
            class="p-button-sm"
            (onClick)="delete(location.id)">
          </p-button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</p-card>